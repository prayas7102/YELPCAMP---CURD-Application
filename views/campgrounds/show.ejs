<%- include('../partials/navbar')%>
<%- include('../partials/flash') %>

<div class="row" style="margin-bottom: 100px;" >
	
	<div class="col-sm-6">
	  <div class="card">
		<div class="card-body">
			<img src="<%=campgrounds.image%>" height="400px" width="700px" class="card-img-top" alt="...">
			<div class="card-body">
			  <h5 class="card-title"><%=campgrounds.title%></h5>
			  <p class="card-text"><%=campgrounds.location%></p>
			</div>
			<ul class="list-group list-group-flush">
			  <li class="list-group-item"><%=campgrounds.description%></li>
			  <li class="list-group-item"><%=campgrounds.author.username%></li>
			  <li class="list-group-item"><%=campgrounds.price%></li>
			</ul>
			<div class="card-body">
			<% if(currentuser._id.equals(campgrounds.author._id)){ %>
				<a href="/campgrounds/<%=campgrounds._id%>/edit" class="card-link btn btn-warning">EDIT</a>
				<form class="d-inline" action="/campgrounds/<%=campgrounds._id%>?_method=DELETE" method="POST">
				  <button  class="d-inline btn btn-danger">DELETE</button>
				</form>
			<% } %>
			<a href="/campgrounds" class="card-link btn btn-info">All campgrounds</a>
			</div>
		</div>
	  </div>
	</div>
	<% if(currentuser){%>
	<div class="col-sm-6" >
	  <div class="card">
		<div class="card-body">
			<form method="POST" action="/campgrounds/<%=campgrounds._id%>/review" class="validated-form" novalidate>
				<div><label for="rating" class="form-label">LEAVE A REVIEW</label></div>
						<fieldset class="rating">
							<input type="radio" id="star5" name="review[star]" value="5" required/><label for="star5" class="full" title="Awesome"></label>
							<input type="radio" id="star4" name="review[star]" value="4" required/><label for="star4" class="full"></label>
							<input type="radio" id="star3" name="review[star]" value="3" required/><label for="star3" class="full"></label>
							<input type="radio" id="star2" name="review[star]" value="2" required/><label for="star2" class="full"></label>
							<input type="radio" id="star1" name="review[star]" value="1" required/><label for="star1" class="full"></label>
						</fieldset>
				
				<!-- <input type="range" min="1" max="5" name="review[star]" class="form-range" id="customRange1" required> -->
				<div class="form-floating">
					<textarea class="form-control" id="floatingTextarea" placeholder="Leave a comment here" name="review[body]" style="height: 100px;width: 100%;" required></textarea>
					<div style="margin: 1em;"><button class="btn btn-success">SUBMIT</button>
					</div>
				  </div>
				  
			  </form>
			  <% for(r of campgrounds.reviews){ %>
				<div class="card" style="width: 30rem;">
				<div class="card-body">
					<h5 class="card-title" style="display: inline;">Ratings: 
						<h5 class="card-subtitle mb-2 text-muted" style="display: inline;"><%=r.star %></h5>
						<% for(var i=0;i<r.star;i++)	{%>
							<span class="fa fa-star checked"></span>
						<%}%>
						<% for(var i=0;i<5-r.star;i++)	{%>
							<span class="fa fa-star "></span>
						<%}%>
					<h5 class="card-title">Reviews:</h5>
					<p class="card-text"><%=r.body%></p>
					<p class="card-text">Submitted by: <%= r.person.username  %></p>
					<%if(r.person.equals(currentuser._id)){%>
					<form class="d-inline" action="/review/<%=r._id%>/camp/<%=campgrounds._id%>?_method=DELETE" method="POST">
						<button  class="d-inline btn btn-danger">DELETE</button>
					</form>
					<%}%>
					</div>
			  <%}%>
			  </div>
		</div>
	  </div>
	</div>
	<%}%>
</div>
<%- include('../partials/footer')%>
<script>
	// Example starter JavaScript for disabling form submissions if there are invalid fields
(function () {
  'use strict'

  // Fetch all the forms we want to apply custom Bootstrap validation styles to
  var forms = document.querySelectorAll('.validated-form')

  // Loop over them and prevent submission
  Array.prototype.slice.call(forms)
    .forEach(function (form) {
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault()
          event.stopPropagation()
        }

        form.classList.add('was-validated')
      }, false)
    })
})()
</script>